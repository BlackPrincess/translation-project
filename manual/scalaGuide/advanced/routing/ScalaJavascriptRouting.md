<!--
# Javascript Routing
-->
# Javascript ルーティング

<!--
The play router is able to generate Javascript code to handle routing from Javascript running client side back to your application. The Javascript router aids in refactoring your application. If you change the structure of your URLs or parameter names your Javascript gets automatically updated to use that new structure.
-->
Play のルータには、クライアントサイドで実行される JavaScript から サーバアプリケーションへのルーティングを行うための Javascript コードを生成する機能があります。Javascript ルータ はアプリケーションのリファクタリングを支援します。アプリケーションの URL 構成やパラメータ名を変更しても、Javascript は自動的に新しい構造を使うよう更新されます。

<!--
## Generating a Javascript router
-->
## Javascript ルータの生成

<!--
The first step to using Play's Javascript router is to generate it. The router will only expose the routes that you explicitly declare thus minimising the size of the Javascript code.
-->
Play の Javascript ルータを利用するにあたってまず必要なことは、それを生成することです。Javascript ルータは、設定時に宣言されたルートだけを提供するようになっています。これにより、生成される Javascript コードのサイズが最小限になります。

<!--
There are two ways to generate a Javascript router. One is to embed the router in the HTML page using template directives. The other is to generate Javascript resources in an action that can be downloaded, cached and shared between pages.
-->
Javascript ルータの生成方法は二通りあります。一つは Scala テンプレートの関数を使ってルータを HTML ページに埋め込むというものです。もう一つは、アクション内で Javascript リソースを生成して、様々なページからダウンロード、キャッシュ、そして共有できるようにするというものです。

<!--
### Embedded router
-->
### 埋め込みルータ

<!--
An embedded router can be generated using the ``@javascriptRouter`` directive inside a Scala template. This is typically done inside the main decorating template.
-->
埋め込みルータは Scala テンプレート内で ``@javascriptRouter`` 関数を呼び出すことで生成できます。記述箇所としてよくあるのは、親テンプレートでしょう。

    @helper.javascriptRouter("jsRoutes")(
      routes.javascript.Users.list,
      routes.javascript.Users.get
    )

<!--
The first parameter is the name of the global variable that the router will be placed in. The second parameter is the list of Javascript routes that should be included in this router. In order to use this function, your template must have an implicit RequestHeader in scope. For example this can be made available by adding ``(implicit req:
RequestHeader)`` to the end of your parameter declarations.
-->
第一引数は生成されるルータのグローバル変数名です。第二引数はこのルータに含められるルートのリストです。この関数を利用するためには、テンプレートのスコープ内に implicit な RequestHeader が必要です。例えば、 ``(implicit req: RequestHeader)`` をテンプレートの引数宣言の最後に追加するとよいでしょう。

<!--
### Router resource
-->
### ルータリソース

<!--
A router resource can be generated by creating an action that invokes the router generator. It has a similar syntax to embedding the router in a template:
-->
ルータリソースの作り方は、ルータジェネレータを呼び出すアクションを作る、というものです。ルータジェネレータを呼び出す際の文法は、 Scala テンプレート内にルータを埋め込む際のそれと似ています。

    def javascriptRoutes = Action { implicit request =>
      import routes.javascript._
      Ok(
        Routes.javascriptRouter("jsRoutes")(
          Users.list,
          Users.get
        )
      ).as("text/javascript")
    }
    
<!--
Then, add the corresponding route:
-->
それから、対応するルートを追加します:

    GET /javascriptRoutes  controllers.Application.javascriptRoutes

<!--
Having implemented this action, and adding it to your routes file, you can then include it as a resource in your templates:
-->
このようなアクションを実装して routes ファイルへ追加したら、 Scala テンプレート内で以下のような記述をすることでルータを読み込むことができます。

    <script type="text/javascript" src="@routes.Application.javascriptRoutes"></script>

<!--
## Using the router
-->
## ルータの利用

<!--
Using jQuery as an example, making a call is as simple as:
-->
サンプルとして jQuery を使います。呼び出し方は以下に示すとおりシンプルです:

    $.ajax(jsRoutes.controllers.Users.get(someId))
      .done( /*...*/ )
      .fail( /*...*/ );

<!--
The router also makes a few other properties available including the ``url``, the ``type`` (the HTTP method), the ``absoluteURL`` and the ``webSocketURL``. For example the above call to jQuery's ajax function can also be made like:
-->
ルータは ``url``, (HTTP メソッドの) ``type``, ``absoluteURL`` そして ``webSocketURL`` を含むいくつかのプロパティを提供します。例えば、上記の jQuery による ajax 関数の呼び出しは次のように書くこともできます:

    var r = jsRoutes.controllers.Users.get(someId);
    $.ajax({url: r.url, type: r.type, success: /*...*/, error: /*...*/ });

<!--
The above approach is required where other properties need setting such as success, error, context etc.
-->
このアプローチは、 success, error, context といった、その他のプロパティを指定したい場合に必要です。

<!--
## jQuery ajax method support
-->
## jQuery ajax メソッドのサポート

<!--
> **Note:** Built-in support for jQuery's ajax function will be removed in a future release. This section on the built-in support is provided for reference purposes only. Please do not use the router's ajax function in new code and consider upgrading existing code as soon as possible. The previous section on using the router documents how jQuery should be used.
-->
> **注意:** jQuery の ajax 関数の組み込みサポートは将来のリリースで削除されるでしょう。組み込みサポートに関するこの節は、参考のみを目的として提供されています。新規のコードでルータの ajax 関数を使わず、既存のコードをできる限り速やかにアップグレードすることを検討してください。ルータの使い方に関する前の節において、jQuery がどのように使われるべきか記述しています。

<!--
If jQuery isn't your thing, or if you'd like to decorate the jQuery ajax method in some way, you can provide a function to the router to use to perform ajax queries. This function must accept the object that is passed to the ``ajax`` router method, and should expect the router to have set the ``type`` and ``url`` properties on it to the appropriate method and url for the router request.
-->
jQuery をお使いでないか、または jQuery の ajax メソッドをラップしたいといった場合には、ajax リクエストを行うための任意の関数をルータに提供することができます。この関数はルータの ``ajax`` メソッドの引数と同じ形式のオブジェクトを引数にとります。また、このオブジェクトの ``type`` と ``url`` プロパティはそれぞれルータがリクエストに応じて設定してくれるものとします。

<!--
To define this function, in your action pass the ``ajaxMethod`` method parameter, eg:
-->
この関数を定義するためには、アクション内でメソッドに ``ajaxMethod`` という名前の引数を渡しましょう。

    Routes.javascriptRouter("jsRoutes", Some("myAjaxFunction") ...

